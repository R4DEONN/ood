(()=>{"use strict";class e{_observers=new Map;registerObserver(e,t=0){this._observers.has(e)||this._observers.set(e,t)}removeObserver(e){this._observers.delete(e)}notifyObservers(){const e=this.getChangedData(),t=Array.from(this._observers.entries()).sort(((e,t)=>t[1]-e[1]));for(const[s]of t)s.update(e)}getChangedData(){return{}}}class t{left;top;width;height;constructor(e,t,s,i){this.left=e,this.top=t,this.width=s,this.height=i}copyFrom(e){this.left=e.left,this.top=e.top,this.width=e.width,this.height=e.height}}class s{_color;_enabled=!0;constructor(e){this._color=e,void 0===e&&(this._enabled=!1)}enable(e){this._enabled=e}getColor(){if(this._enabled)return this._color}isEnabled(){return this._enabled}setColor(e){this._color=e}}class i extends s{_lineHeight;constructor(e,t){super(e),this._lineHeight=t}getLineHeight(){return this._lineHeight}}class r{_styles;constructor(e=[]){this._styles=e}enable(e){this._styles.forEach((t=>t.enable(e)))}getColor(){return this._styles.every((e=>e.getColor()===this._styles[0].getColor()))?this._styles[0]?.getColor():void 0}isEnabled(){return this._styles.every((e=>e.isEnabled()))}setColor(e){this._styles.forEach((t=>t.setColor(e)))}insertStyle(e,t){if(void 0===t)this._styles.push(e);else{if(t<0||t>this._styles.length)throw new Error("Position out of bounds");this._styles.splice(t,0,e)}}removeStyleAtIndex(e){if(!(e>=0&&e<this._styles.length))throw new Error("Shape does not exist");this._styles.splice(e,1)}clear(){this._styles=[]}}class h extends r{constructor(e=[]){super(e)}getLineHeight(){return this._styles.every((e=>e.getLineHeight()===this._styles[0].getLineHeight()))?(this._styles?.[0]).getLineHeight():void 0}insertStyle(e,t){super.insertStyle(e,t)}}class l extends e{_drawingStrategy;_fillStyle;_strokeStyle;_frame;constructor(e,t,s,i){super(),this._drawingStrategy=e,this._fillStyle=t,this._strokeStyle=s,this._frame=i}draw(e){this._drawingStrategy(e,this)}getFillStyle(){return this._fillStyle}getFrame(){return this._frame}getGroup(){}getOutlineStyle(){return this._strokeStyle}setFrame(e){this._frame=e,this.notifyObservers()}setFillStyle(e){this._fillStyle=e}setOutlineStyle(e){this._strokeStyle=e}clone(){return new l(this._drawingStrategy,new s(this._fillStyle.getColor()),new i(this._strokeStyle.getColor(),this._strokeStyle.getLineHeight()),new t(this._frame.left,this._frame.top,this._frame.width,this._frame.height))}}class o{_shapes;constructor(...e){this._shapes=e}getShapesCount(){return this._shapes.length}getShapeAtIndex(e){const t=this._shapes[e];if(!t)throw new Error("Shape does not exist");return t}insertShape(e,t){if(void 0===t)this._shapes.push(e);else{if(t<0||t>this._shapes.length)throw new Error("Position out of bounds");this._shapes.splice(t,0,e)}}removeShapeAtIndex(e){if(!(e>=0&&e<this._shapes.length))throw new Error("Shape does not exist");this._shapes.splice(e,1)}enumerateShapes(e){this._shapes.forEach(e)}}function n(e,t){t.top<e.top&&(e.top=t.top),t.left<e.left&&(e.left=t.left),t.width>e.width&&(e.width=t.width),t.height>e.height&&(e.height=t.height)}class a extends o{_observers=new Map;_frame=new t(0,0,0,0);_fillStyle=new r;_outlineStyle=new h;constructor(...e){super(...e),this.enumerateShapes((e=>{e.registerObserver(this),this._fillStyle.insertStyle(e.getFillStyle()),this._outlineStyle.insertStyle(e.getOutlineStyle())})),this._updateFrame()}update(e){this._updateFrame()}_updateFrame(){const e=new t(Number.MAX_VALUE,Number.MAX_VALUE,0,0);this.enumerateShapes((t=>{n(e,t.getFrame())})),this._frame.copyFrom(e),this.notifyObservers()}draw(e){this.enumerateShapes((t=>t.draw(e)))}getFillStyle(){return this._fillStyle}getOutlineStyle(){return this._outlineStyle}getFrame(){return this._frame}getGroup(){return this}setFrame(e){const s=e.width/this._frame.width,i=e.height/this._frame.height;this.enumerateShapes((r=>{const h=r.getFrame(),l=e.left+(h.left-this._frame.left)*s,o=e.top+(h.top-this._frame.top)*i,a=h.width*s,_=h.height*i;r.setFrame(new t(l,o,a,_)),n(this._frame,r.getFrame())}))}setFillStyle(e){this.enumerateShapes((t=>t.setFillStyle(e))),this._fillStyle.clear(),this._fillStyle.insertStyle(e)}setOutlineStyle(e){this.enumerateShapes((t=>t.setOutlineStyle(e))),this._outlineStyle.clear(),this._outlineStyle.insertStyle(e)}clone(){const e=[];return this.enumerateShapes((t=>e.push(t.clone()))),new a(...e)}registerObserver(e,t=0){this._observers.has(e)||this._observers.set(e,t)}removeObserver(e){this._observers.delete(e)}notifyObservers(){const e=Array.from(this._observers.entries()).sort(((e,t)=>t[1]-e[1]));for(const[t]of e)t.update()}}class _{_width;_height;_shapeCollection=new o;_backgroundColor=void 0;constructor(e,t){this._width=e,this._height=t}draw(e){this._shapeCollection.enumerateShapes((t=>t.draw(e)))}getWidth(){return this._width}getHeight(){return this._height}getShapesCount(){return this._shapeCollection.getShapesCount()}getShapeAtIndex(e){return this._shapeCollection.getShapeAtIndex(e)}insertShape(e,t){this._shapeCollection.insertShape(e,t)}removeShapeAtIndex(e){this._shapeCollection.removeShapeAtIndex(e)}getBackgroundColor(){return this._backgroundColor}setBackgroundColor(e){this._backgroundColor=e}}class g{x;y;constructor(e,t){this.x=e,this.y=t}}function c(e,t){const s=t.getFrame(),i=t.getOutlineStyle(),r=t.getFillStyle();e.setLineColor(i?.getColor()),e.setFillColor(r?.getColor()),e.drawEllipse(s.left,s.top,s.width,s.height)}function u(e){return(t,s)=>{const i=s.getFrame(),r=s.getOutlineStyle(),h=s.getFillStyle(),l=i.left+i.width/2,o=i.top+i.height/2,n=i.width/2,a=i.height/2,_=[],c=2*Math.PI/e;for(let t=0;t<e;t++){const e=t*c-Math.PI/2,s=l+n*Math.cos(e),i=o+a*Math.sin(e);_.push(new g(s,i))}t.setLineColor(r?.getColor()),t.setFillColor(h?.getColor()),t.drawPolygon(_)}}function p(e){if(!Number.isInteger(e)||e<0)throw new Error("Input must be a non-negative integer.");return`#${e.toString(16).toUpperCase().padStart(6,"0")}`}const y=document.getElementById("canvas"),d=new class{_canvas;_ctx;_fill=!1;_stroke=!1;constructor(e){this._canvas=e,this._ctx=e.getContext("2d")}setFillColor(e){void 0!==e?(this._ctx.fillStyle=p(e),this._fill=!0):this._fill=!1}drawPolygon(e){this._ctx.beginPath(),this._ctx.moveTo(e[0].x,e[0].y),e.forEach(((e,t)=>{t>0&&this._ctx.lineTo(e.x,e.y)})),this._ctx.closePath(),this._fill&&this._ctx.fill(),this._stroke&&this._ctx.stroke()}drawEllipse(e,t,s,i){this._ctx.ellipse(e+s/2,t+i/2,s/2,i/2,0,0,2*Math.PI),this._fill&&this._ctx.fill(),this._stroke&&this._ctx.stroke()}setLineColor(e){void 0!==e?(this._ctx.strokeStyle=p(e),this._stroke=!0):this._stroke=!1}}(y);!function(){const e=new _(1e3,1e3);y.width=e.getWidth(),y.height=e.getHeight();const r=new s(0),h=new i,o=new l(c,r,h,new t(0,0,100,100));e.insertShape(o);const n=new l(u(5),r,h,new t(300,300,100,100)),g=new l(u(3),r,h,new t(300,260,100,100)),p=new l(u(2),r,new i(65280),new t(200,260,100,100)),S=new a(n,g,p);e.insertShape(S);const f=new t(300,300,200,200),w=S.clone();w.setFrame(f),w.getFillStyle().setColor(16711680),e.insertShape(w);const m=new l(c,new s(65280),new i(16711680,1),new t(500,300,150,150));e.insertShape(m),e.draw(d)}()})();